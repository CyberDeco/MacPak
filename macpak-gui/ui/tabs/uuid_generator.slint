import { Button, VerticalBox, HorizontalBox, ScrollView } from "std-widgets.slint";

// ============================================================================
// UUID Generator Tab
// ============================================================================
export component UuidGeneratorTab inherits ScrollView {
    in-out property <string> last-uuid: "";
    in-out property <string> last-handle: "";
    in-out property <[string]> uuid-history: [];
    in-out property <[string]> handle-history: [];
    in-out property <string> copy-status: "";

    callback generate-uuid();
    callback generate-handle();
    callback copy(string);
    callback export-history();
    callback clear-history();

    VerticalBox {
        padding: 20px;
        spacing: 25px;

        // ===== UUID Section =====
        VerticalBox {
            spacing: 12px;

            Text {
                text: "UUID Generator";
                font-size: 24px;
                font-weight: 700;
            }

            Text {
                text: "Generate unique identifiers for BG3 mods (UUID v4 format)";
                font-size: 14px;
                color: #666666;
            }

            HorizontalBox {
                spacing: 10px;
                height: 40px;

                Button {
                    text: "Generate UUID";
                    clicked => { root.generate-uuid(); }
                    primary: true;
                }

                Rectangle {
                    background: #f8f8f8;
                    border-radius: 4px;
                    horizontal-stretch: 1;

                    Text {
                        text: root.last-uuid == "" ? "Click 'Generate UUID' to create" : root.last-uuid;
                        x: 12px;
                        font-size: 14px;
                        font-family: "monospace";
                        vertical-alignment: center;
                        color: root.last-uuid == "" ? #999999 : black;
                    }
                }

                if root.last-uuid != "" : Button {
                    text: "Copy";
                    clicked => { root.copy(root.last-uuid); }
                }
            }
        }

        Rectangle { height: 2px; background: #eeeeee; }

        // ===== Handle Section =====
        VerticalBox {
            spacing: 12px;

            Text {
                text: "TranslatedString Handle Generator";
                font-size: 24px;
                font-weight: 700;
            }

            Text {
                text: "Generate numeric handles for translated strings in localization files";
                font-size: 14px;
                color: #666666;
            }

            HorizontalBox {
                spacing: 10px;
                height: 40px;

                Button {
                    text: "Generate Handle";
                    clicked => { root.generate-handle(); }
                    primary: true;
                }

                Rectangle {
                    background: #f8f8f8;
                    border-radius: 4px;
                    horizontal-stretch: 1;

                    Text {
                        text: root.last-handle == "" ? "Click 'Generate Handle' to create" : "h" + root.last-handle;
                        x: 12px;
                        font-size: 14px;
                        font-family: "monospace";
                        vertical-alignment: center;
                        color: root.last-handle == "" ? #999999 : black;
                    }
                }

                if root.last-handle != "" : Button {
                    text: "Copy";
                    clicked => { root.copy(root.last-handle); }
                }
            }
        }

        Rectangle { height: 2px; background: #eeeeee; }

        // ===== History Section =====
        VerticalBox {
            spacing: 12px;

            HorizontalBox {
                Text {
                    text: "Generation History";
                    font-size: 20px;
                    font-weight: 700;
                }

                Rectangle { horizontal-stretch: 1; }

                if root.copy-status != "" : Text {
                    text: root.copy-status;
                    font-size: 12px;
                    color: #28a745;
                    vertical-alignment: center;
                }

                Button {
                    text: "Export JSON";
                    clicked => { root.export-history(); }
                    enabled: root.uuid-history.length > 0 || root.handle-history.length > 0;
                }

                Button {
                    text: "Clear";
                    clicked => { root.clear-history(); }
                    enabled: root.uuid-history.length > 0 || root.handle-history.length > 0;
                }
            }

            HorizontalBox {
                spacing: 15px;
                vertical-stretch: 1;

                // UUID History
                VerticalBox {
                    horizontal-stretch: 1;

                    Text {
                        text: "UUIDs (" + root.uuid-history.length + ")";
                        font-size: 14px;
                        font-weight: 600;
                    }

                    Rectangle {
                        background: #f8f8f8;
                        border-radius: 4px;
                        vertical-stretch: 1;

                        ScrollView {
                            VerticalBox {
                                padding: 8px;
                                spacing: 4px;

                                for uuid in root.uuid-history : HorizontalBox {
                                    height: 28px;

                                    Text {
                                        text: uuid;
                                        font-size: 12px;
                                        font-family: "monospace";
                                        vertical-alignment: center;
                                        horizontal-stretch: 1;
                                    }

                                    TouchArea {
                                        width: 40px;
                                        clicked => { root.copy(uuid); }

                                        Text {
                                            text: "Copy";
                                            font-size: 11px;
                                            color: #0078d4;
                                            horizontal-alignment: center;
                                            vertical-alignment: center;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }

                // Handle History
                VerticalBox {
                    horizontal-stretch: 1;

                    Text {
                        text: "Handles (" + root.handle-history.length + ")";
                        font-size: 14px;
                        font-weight: 600;
                    }

                    Rectangle {
                        background: #f8f8f8;
                        border-radius: 4px;
                        vertical-stretch: 1;

                        ScrollView {
                            VerticalBox {
                                padding: 8px;
                                spacing: 4px;

                                for handle in root.handle-history : HorizontalBox {
                                    height: 28px;

                                    Text {
                                        text: "h" + handle;
                                        font-size: 12px;
                                        font-family: "monospace";
                                        vertical-alignment: center;
                                        horizontal-stretch: 1;
                                    }

                                    TouchArea {
                                        width: 40px;
                                        clicked => { root.copy(handle); }

                                        Text {
                                            text: "Copy";
                                            font-size: 11px;
                                            color: #0078d4;
                                            horizontal-alignment: center;
                                            vertical-alignment: center;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
